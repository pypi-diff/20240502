# Comparing `tmp/odoo_addon_stock_move_packaging_qty-16.0.1.4.0.2-py3-none-any.whl.zip` & `tmp/odoo_addon_stock_move_packaging_qty-16.0.1.5.0-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,27 +1,27 @@
-Zip file size: 32423 bytes, number of entries: 25
--rw-r--r--  2.0 unx     3656 b- defN 24-Apr-30 06:36 odoo/addons/stock_move_packaging_qty/README.rst
--rw-r--r--  2.0 unx       21 b- defN 24-Apr-30 06:36 odoo/addons/stock_move_packaging_qty/__init__.py
--rw-r--r--  2.0 unx      705 b- defN 24-Apr-30 06:36 odoo/addons/stock_move_packaging_qty/__manifest__.py
--rw-r--r--  2.0 unx     3741 b- defN 24-Apr-30 06:36 odoo/addons/stock_move_packaging_qty/i18n/es.po
--rw-r--r--  2.0 unx     3921 b- defN 24-Apr-30 06:36 odoo/addons/stock_move_packaging_qty/i18n/it.po
--rw-r--r--  2.0 unx     3068 b- defN 24-Apr-30 06:36 odoo/addons/stock_move_packaging_qty/i18n/stock_move_packaging_qty.pot
--rw-r--r--  2.0 unx      659 b- defN 24-Apr-30 06:36 odoo/addons/stock_move_packaging_qty/migrations/15.0.0/pre-migrate.py
--rw-r--r--  2.0 unx       55 b- defN 24-Apr-30 06:36 odoo/addons/stock_move_packaging_qty/models/__init__.py
--rw-r--r--  2.0 unx     5003 b- defN 24-Apr-30 06:36 odoo/addons/stock_move_packaging_qty/models/stock_move.py
--rw-r--r--  2.0 unx     2978 b- defN 24-Apr-30 06:36 odoo/addons/stock_move_packaging_qty/models/stock_move_line.py
--rw-r--r--  2.0 unx      254 b- defN 24-Apr-30 06:36 odoo/addons/stock_move_packaging_qty/readme/CONTRIBUTORS.rst
--rw-r--r--  2.0 unx       72 b- defN 24-Apr-30 06:36 odoo/addons/stock_move_packaging_qty/readme/DESCRIPTION.rst
--rw-r--r--  2.0 unx      176 b- defN 24-Apr-30 06:36 odoo/addons/stock_move_packaging_qty/readme/ROADMAP.rst
--rw-r--r--  2.0 unx     9455 b- defN 24-Apr-30 06:36 odoo/addons/stock_move_packaging_qty/static/description/icon.png
--rw-r--r--  2.0 unx    13387 b- defN 24-Apr-30 06:36 odoo/addons/stock_move_packaging_qty/static/description/index.html
--rw-r--r--  2.0 unx       44 b- defN 24-Apr-30 06:36 odoo/addons/stock_move_packaging_qty/tests/__init__.py
--rw-r--r--  2.0 unx     3643 b- defN 24-Apr-30 06:36 odoo/addons/stock_move_packaging_qty/tests/test_stock_move_packaging_qty.py
--rw-r--r--  2.0 unx     4922 b- defN 24-Apr-30 06:36 odoo/addons/stock_move_packaging_qty/views/report_stock_picking.xml
--rw-r--r--  2.0 unx     4812 b- defN 24-Apr-30 06:36 odoo/addons/stock_move_packaging_qty/views/stock_move_line_view.xml
--rw-r--r--  2.0 unx     3178 b- defN 24-Apr-30 06:36 odoo/addons/stock_move_packaging_qty/views/stock_move_view.xml
--rw-r--r--  2.0 unx     1422 b- defN 24-Apr-30 06:36 odoo/addons/stock_move_packaging_qty/views/stock_picking_form_view.xml
--rw-r--r--  2.0 unx     4238 b- defN 24-Apr-30 06:37 odoo_addon_stock_move_packaging_qty-16.0.1.4.0.2.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 24-Apr-30 06:37 odoo_addon_stock_move_packaging_qty-16.0.1.4.0.2.dist-info/WHEEL
--rw-r--r--  2.0 unx        5 b- defN 24-Apr-30 06:37 odoo_addon_stock_move_packaging_qty-16.0.1.4.0.2.dist-info/top_level.txt
--rw-rw-r--  2.0 unx     2876 b- defN 24-Apr-30 06:37 odoo_addon_stock_move_packaging_qty-16.0.1.4.0.2.dist-info/RECORD
-25 files, 72383 bytes uncompressed, 27459 bytes compressed:  62.1%
+Zip file size: 33315 bytes, number of entries: 25
+-rw-r--r--  2.0 unx     3839 b- defN 24-May-02 10:45 odoo/addons/stock_move_packaging_qty/README.rst
+-rw-r--r--  2.0 unx       21 b- defN 24-May-02 10:45 odoo/addons/stock_move_packaging_qty/__init__.py
+-rw-r--r--  2.0 unx      722 b- defN 24-May-02 10:45 odoo/addons/stock_move_packaging_qty/__manifest__.py
+-rw-r--r--  2.0 unx     3741 b- defN 24-May-02 10:45 odoo/addons/stock_move_packaging_qty/i18n/es.po
+-rw-r--r--  2.0 unx     3921 b- defN 24-May-02 10:45 odoo/addons/stock_move_packaging_qty/i18n/it.po
+-rw-r--r--  2.0 unx     3068 b- defN 24-May-02 10:45 odoo/addons/stock_move_packaging_qty/i18n/stock_move_packaging_qty.pot
+-rw-r--r--  2.0 unx      659 b- defN 24-May-02 10:45 odoo/addons/stock_move_packaging_qty/migrations/15.0.0/pre-migrate.py
+-rw-r--r--  2.0 unx       55 b- defN 24-May-02 10:45 odoo/addons/stock_move_packaging_qty/models/__init__.py
+-rw-r--r--  2.0 unx     7401 b- defN 24-May-02 10:45 odoo/addons/stock_move_packaging_qty/models/stock_move.py
+-rw-r--r--  2.0 unx     2305 b- defN 24-May-02 10:45 odoo/addons/stock_move_packaging_qty/models/stock_move_line.py
+-rw-r--r--  2.0 unx      254 b- defN 24-May-02 10:45 odoo/addons/stock_move_packaging_qty/readme/CONTRIBUTORS.rst
+-rw-r--r--  2.0 unx       72 b- defN 24-May-02 10:45 odoo/addons/stock_move_packaging_qty/readme/DESCRIPTION.rst
+-rw-r--r--  2.0 unx      176 b- defN 24-May-02 10:45 odoo/addons/stock_move_packaging_qty/readme/ROADMAP.rst
+-rw-r--r--  2.0 unx     9455 b- defN 24-May-02 10:45 odoo/addons/stock_move_packaging_qty/static/description/icon.png
+-rw-r--r--  2.0 unx    13559 b- defN 24-May-02 10:45 odoo/addons/stock_move_packaging_qty/static/description/index.html
+-rw-r--r--  2.0 unx       44 b- defN 24-May-02 10:45 odoo/addons/stock_move_packaging_qty/tests/__init__.py
+-rw-r--r--  2.0 unx     9110 b- defN 24-May-02 10:45 odoo/addons/stock_move_packaging_qty/tests/test_stock_move_packaging_qty.py
+-rw-r--r--  2.0 unx     4922 b- defN 24-May-02 10:45 odoo/addons/stock_move_packaging_qty/views/report_stock_picking.xml
+-rw-r--r--  2.0 unx     5136 b- defN 24-May-02 10:45 odoo/addons/stock_move_packaging_qty/views/stock_move_line_view.xml
+-rw-r--r--  2.0 unx     3178 b- defN 24-May-02 10:45 odoo/addons/stock_move_packaging_qty/views/stock_move_view.xml
+-rw-r--r--  2.0 unx     1422 b- defN 24-May-02 10:45 odoo/addons/stock_move_packaging_qty/views/stock_picking_form_view.xml
+-rw-r--r--  2.0 unx     4419 b- defN 24-May-02 10:45 odoo_addon_stock_move_packaging_qty-16.0.1.5.0.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 24-May-02 10:45 odoo_addon_stock_move_packaging_qty-16.0.1.5.0.dist-info/WHEEL
+-rw-r--r--  2.0 unx        5 b- defN 24-May-02 10:45 odoo_addon_stock_move_packaging_qty-16.0.1.5.0.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx     2868 b- defN 24-May-02 10:45 odoo_addon_stock_move_packaging_qty-16.0.1.5.0.dist-info/RECORD
+25 files, 80444 bytes uncompressed, 28367 bytes compressed:  64.7%
```

## zipnote {}

```diff
@@ -57,20 +57,20 @@
 
 Filename: odoo/addons/stock_move_packaging_qty/views/stock_move_view.xml
 Comment: 
 
 Filename: odoo/addons/stock_move_packaging_qty/views/stock_picking_form_view.xml
 Comment: 
 
-Filename: odoo_addon_stock_move_packaging_qty-16.0.1.4.0.2.dist-info/METADATA
+Filename: odoo_addon_stock_move_packaging_qty-16.0.1.5.0.dist-info/METADATA
 Comment: 
 
-Filename: odoo_addon_stock_move_packaging_qty-16.0.1.4.0.2.dist-info/WHEEL
+Filename: odoo_addon_stock_move_packaging_qty-16.0.1.5.0.dist-info/WHEEL
 Comment: 
 
-Filename: odoo_addon_stock_move_packaging_qty-16.0.1.4.0.2.dist-info/top_level.txt
+Filename: odoo_addon_stock_move_packaging_qty-16.0.1.5.0.dist-info/top_level.txt
 Comment: 
 
-Filename: odoo_addon_stock_move_packaging_qty-16.0.1.4.0.2.dist-info/RECORD
+Filename: odoo_addon_stock_move_packaging_qty-16.0.1.5.0.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## odoo/addons/stock_move_packaging_qty/README.rst

```diff
@@ -3,15 +3,15 @@
 ===================
 
 .. 
    !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
    !! This file is generated by oca-gen-addon-readme !!
    !! changes will be overwritten.                   !!
    !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
-   !! source digest: sha256:f762cbab1bc1e42ef6e66f92bbd7557223f9c6faa21797ac22edb0e40fedad71
+   !! source digest: sha256:5b8f860ba729ede992476459b447110fc34c95d4543e9f17afe7f0489724975e
    !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
 
 .. |badge1| image:: https://img.shields.io/badge/maturity-Beta-yellow.png
     :target: https://odoo-community.org/page/development-status
     :alt: Beta
 .. |badge2| image:: https://img.shields.io/badge/licence-LGPL--3-blue.png
     :target: http://www.gnu.org/licenses/lgpl-3.0-standalone.html
@@ -81,15 +81,18 @@
 OCA, or the Odoo Community Association, is a nonprofit organization whose
 mission is to support the collaborative development of Odoo features and
 promote its widespread use.
 
 .. |maintainer-yajo| image:: https://github.com/yajo.png?size=40px
     :target: https://github.com/yajo
     :alt: yajo
+.. |maintainer-EmilioPascual| image:: https://github.com/EmilioPascual.png?size=40px
+    :target: https://github.com/EmilioPascual
+    :alt: EmilioPascual
 
-Current `maintainer <https://odoo-community.org/page/maintainer-role>`__:
+Current `maintainers <https://odoo-community.org/page/maintainer-role>`__:
 
-|maintainer-yajo| 
+|maintainer-yajo| |maintainer-EmilioPascual| 
 
 This module is part of the `OCA/stock-logistics-warehouse <https://github.com/OCA/stock-logistics-warehouse/tree/16.0/stock_move_packaging_qty>`_ project on GitHub.
 
 You are welcome to contribute. To learn how please visit https://odoo-community.org/page/Contribute.
```

## odoo/addons/stock_move_packaging_qty/__manifest__.py

```diff
@@ -1,20 +1,20 @@
 # Copyright 2021 ForgeFlow S.L. (https://www.forgeflow.com)
 # License LGPL-3.0 or later (https://www.gnu.org/licenses/lgpl.html).
 {
     "name": "Stock Packaging Qty",
     "summary": "Add packaging fields in the stock moves",
-    "version": "16.0.1.4.0",
+    "version": "16.0.1.5.0",
     "author": "ForgeFlow, Odoo Community Association (OCA)",
     "website": "https://github.com/OCA/stock-logistics-warehouse",
     "category": "Warehouse",
     "depends": ["stock"],
     "data": [
         "views/report_stock_picking.xml",
         "views/stock_move_line_view.xml",
         "views/stock_move_view.xml",
         "views/stock_picking_form_view.xml",
     ],
     "license": "LGPL-3",
     "installable": True,
-    "maintainers": ["yajo"],
+    "maintainers": ["yajo", "EmilioPascual"],
 }
```

## odoo/addons/stock_move_packaging_qty/models/stock_move.py

```diff
@@ -1,12 +1,12 @@
 # Copyright 2020 Camptocamp SA
 # Copyright 2021 ForgeFlow, S.L.
 # License LGPL-3.0 or later (https://www.gnu.org/licenses/lgpl).
 from odoo import _, api, exceptions, fields, models
-from odoo.tools import float_compare
+from odoo.tools import float_compare, float_round
 
 
 class StockMove(models.Model):
     _inherit = "stock.move"
 
     product_packaging_qty = fields.Float(
         string="Pkgs. Demand",
@@ -107,23 +107,78 @@
         ]["digits"][1]
         for line in self.move_line_ids:
             if float_compare(line.qty_done, line.reserved_uom_qty, digits):
                 continue
             if not line.product_packaging_id:
                 line.product_packaging_qty_done = 0
                 continue
-            line.product_packaging_qty_done = (
-                line.product_packaging_id._check_qty(
-                    line.qty_done, line.product_uom_id, "DOWN"
-                )
-                / line.product_packaging_id.qty
-            )
+            line.product_packaging_qty_done = line.product_packaging_qty_reserved
         return result
 
     def _clear_quantities_to_zero(self):
         """Clear packaging qtys when clicking on "Clear Quantities"."""
         result = super()._clear_quantities_to_zero()
         for line in self.move_line_ids:
             if line.qty_done:
                 continue
             line.product_packaging_qty_done = 0
         return result
+
+    def _action_assign(self, force_qty=False):
+        """Set the packaging qty reserved when assigning."""
+        res = super()._action_assign(force_qty=force_qty)
+        moves_to_assign = self
+        move_lines_origin = self.env["stock.move.line"].read_group(
+            [
+                ("move_id", "in", moves_to_assign.mapped("move_orig_ids").ids),
+                (
+                    "move_id.state",
+                    "not in",
+                    ("draft", "waiting", "confirmed", "cancel"),
+                ),
+                ("move_id.product_packaging_id", "!=", False),
+            ],
+            ["qty_done", "product_packaging_qty_done"],
+            ["move_id", "location_dest_id", "lot_id", "result_package_id", "owner_id"],
+            lazy=False,
+        )
+        move_lines_origin_dict = {
+            (
+                ml.get("location_dest_id")[0] if ml.get("location_dest_id") else False,
+                ml.get("lot_id")[0] if ml.get("lot_id") else False,
+                ml.get("result_package_id")[0]
+                if ml.get("result_package_id")
+                else False,
+                ml.get("owner_id")[0] if ml.get("owner_id") else False,
+            ): {
+                "qty_done": ml.get("qty_done"),
+                "product_packaging_qty_done": ml.get("product_packaging_qty_done"),
+            }
+            for ml in move_lines_origin
+        }
+        for line in moves_to_assign.move_line_ids.filtered("product_packaging_id"):
+            found_move_lines_origin = move_lines_origin_dict.get(
+                (
+                    line.location_id.id,
+                    line.lot_id.id,
+                    line.package_id.id,
+                    line.owner_id.id,
+                ),
+                {},
+            )
+            if found_move_lines_origin and found_move_lines_origin.get(
+                "qty_done"
+            ) == round(
+                line.reserved_uom_qty,
+                self.env["decimal.precision"].precision_get("Product Unit of Measure"),
+            ):
+                line.product_packaging_qty_reserved = found_move_lines_origin.get(
+                    "product_packaging_qty_done"
+                )
+            elif not line.product_packaging_id.qty:
+                continue
+            else:
+                line.product_packaging_qty_reserved = float_round(
+                    line.reserved_qty / line.product_packaging_id.qty,
+                    precision_rounding=line.product_packaging_id.product_uom_id.rounding,
+                )
+        return res
```

## odoo/addons/stock_move_packaging_qty/models/stock_move_line.py

```diff
@@ -1,42 +1,27 @@
 # Copyright 2024 Moduon Team S.L.
 # License LGPL-3.0 or later (https://www.gnu.org/licenses/lgpl-3.0)
-from odoo import api, fields, models
-from odoo.tools import float_round
+from odoo import fields, models
 
 
 class StockMoveLine(models.Model):
     _inherit = "stock.move.line"
 
     product_packaging_id = fields.Many2one(
         related="move_id.product_packaging_id", readonly=True
     )
     product_packaging_qty_reserved = fields.Float(
         string="Reserved Pkg. Qty.",
         help="Product packaging quantity reserved.",
-        compute="_compute_product_packaging_qty_reserved",
-        store=True,
     )
     product_packaging_qty_done = fields.Float(
         string="Done Pkg. Qty.",
         help="Product packaging quantity done.",
     )
 
-    @api.depends("product_packaging_id", "reserved_qty")
-    def _compute_product_packaging_qty_reserved(self):
-        """Get the quantity done in product packaging."""
-        self.product_packaging_qty_reserved = False
-        for line in self:
-            if not line.product_packaging_id.qty:
-                continue
-            line.product_packaging_qty_reserved = float_round(
-                line.reserved_qty / line.product_packaging_id.qty,
-                precision_rounding=line.product_packaging_id.product_uom_id.rounding,
-            )
-
     def _get_aggregated_properties(self, move_line=False, move=False):
         """Aggregate by product packaging too."""
         result = super()._get_aggregated_properties(move_line, move)
         pkg = result["move"].product_packaging_id
         result["product_packaging"] = pkg
         result["line_key"] += f"_{pkg.id}"
         return result
```

## odoo/addons/stock_move_packaging_qty/static/description/index.html

```diff
@@ -362,15 +362,15 @@
 <div class="document" id="stock-packaging-qty">
 <h1 class="title">Stock Packaging Qty</h1>
 
 <!-- !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
 !! This file is generated by oca-gen-addon-readme !!
 !! changes will be overwritten.                   !!
 !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
-!! source digest: sha256:f762cbab1bc1e42ef6e66f92bbd7557223f9c6faa21797ac22edb0e40fedad71
+!! source digest: sha256:5b8f860ba729ede992476459b447110fc34c95d4543e9f17afe7f0489724975e
 !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! -->
 <p><a class="reference external image-reference" href="https://odoo-community.org/page/development-status"><img alt="Beta" src="https://img.shields.io/badge/maturity-Beta-yellow.png" /></a> <a class="reference external image-reference" href="http://www.gnu.org/licenses/lgpl-3.0-standalone.html"><img alt="License: LGPL-3" src="https://img.shields.io/badge/licence-LGPL--3-blue.png" /></a> <a class="reference external image-reference" href="https://github.com/OCA/stock-logistics-warehouse/tree/16.0/stock_move_packaging_qty"><img alt="OCA/stock-logistics-warehouse" src="https://img.shields.io/badge/github-OCA%2Fstock--logistics--warehouse-lightgray.png?logo=github" /></a> <a class="reference external image-reference" href="https://translation.odoo-community.org/projects/stock-logistics-warehouse-16-0/stock-logistics-warehouse-16-0-stock_move_packaging_qty"><img alt="Translate me on Weblate" src="https://img.shields.io/badge/weblate-Translate%20me-F47D42.png" /></a> <a class="reference external image-reference" href="https://runboat.odoo-community.org/builds?repo=OCA/stock-logistics-warehouse&amp;target_branch=16.0"><img alt="Try me on Runboat" src="https://img.shields.io/badge/runboat-Try%20me-875A7B.png" /></a></p>
 <p>Add packaging fields in the stock moves, their lines and their reports.</p>
 <p><strong>Table of contents</strong></p>
 <div class="contents local topic" id="contents">
 <ul class="simple">
 <li><a class="reference internal" href="#known-issues-roadmap" id="toc-entry-1">Known issues / Roadmap</a></li>
@@ -420,16 +420,16 @@
 <div class="section" id="maintainers">
 <h2><a class="toc-backref" href="#toc-entry-6">Maintainers</a></h2>
 <p>This module is maintained by the OCA.</p>
 <a class="reference external image-reference" href="https://odoo-community.org"><img alt="Odoo Community Association" src="https://odoo-community.org/logo.png" /></a>
 <p>OCA, or the Odoo Community Association, is a nonprofit organization whose
 mission is to support the collaborative development of Odoo features and
 promote its widespread use.</p>
-<p>Current <a class="reference external" href="https://odoo-community.org/page/maintainer-role">maintainer</a>:</p>
-<p><a class="reference external image-reference" href="https://github.com/yajo"><img alt="yajo" src="https://github.com/yajo.png?size=40px" /></a></p>
+<p>Current <a class="reference external" href="https://odoo-community.org/page/maintainer-role">maintainers</a>:</p>
+<p><a class="reference external image-reference" href="https://github.com/yajo"><img alt="yajo" src="https://github.com/yajo.png?size=40px" /></a> <a class="reference external image-reference" href="https://github.com/EmilioPascual"><img alt="EmilioPascual" src="https://github.com/EmilioPascual.png?size=40px" /></a></p>
 <p>This module is part of the <a class="reference external" href="https://github.com/OCA/stock-logistics-warehouse/tree/16.0/stock_move_packaging_qty">OCA/stock-logistics-warehouse</a> project on GitHub.</p>
 <p>You are welcome to contribute. To learn how please visit <a class="reference external" href="https://odoo-community.org/page/Contribute">https://odoo-community.org/page/Contribute</a>.</p>
 </div>
 </div>
 </div>
 </body>
 </html>
```

### html2text {}

```diff
@@ -30,12 +30,12 @@
     * Eduardo de Miguel (_M_o_d_u_o_n)
 ********** _MM_aa_ii_nn_tt_aa_ii_nn_ee_rr_ss **********
 This module is maintained by the OCA.
 _[_O_d_o_o_ _C_o_m_m_u_n_i_t_y_ _A_s_s_o_c_i_a_t_i_o_n_]
 OCA, or the Odoo Community Association, is a nonprofit organization whose
 mission is to support the collaborative development of Odoo features and
 promote its widespread use.
-Current _m_a_i_n_t_a_i_n_e_r:
-_[_y_a_j_o_]
+Current _m_a_i_n_t_a_i_n_e_r_s:
+_[_y_a_j_o_]_[_E_m_i_l_i_o_P_a_s_c_u_a_l_]
 This module is part of the _O_C_A_/_s_t_o_c_k_-_l_o_g_i_s_t_i_c_s_-_w_a_r_e_h_o_u_s_e project on GitHub.
 You are welcome to contribute. To learn how please visit _h_t_t_p_s_:_/_/_o_d_o_o_-
 _c_o_m_m_u_n_i_t_y_._o_r_g_/_p_a_g_e_/_C_o_n_t_r_i_b_u_t_e.
```

## odoo/addons/stock_move_packaging_qty/tests/test_stock_move_packaging_qty.py

```diff
@@ -29,14 +29,17 @@
         cls.categ_unit = cls.env.ref("uom.product_uom_categ_unit")
         cls.uom_unit = cls.env["uom.uom"].search(
             [("category_id", "=", cls.categ_unit.id), ("uom_type", "=", "reference")],
             limit=1,
         )
         cls.customer_location = cls.env.ref("stock.stock_location_customers")
         cls.supplier_location = cls.env.ref("stock.stock_location_suppliers")
+        cls.picking_type_out = cls.env.ref("stock.picking_type_out")
+        cls.pack_location = cls.env.ref("stock.location_pack_zone")
+        cls.stock_location = cls.env.ref("stock.stock_location_stock")
 
     def test_product_packaging_qty(self):
         move = self.env["stock.move"].create(
             {
                 "name": "Move",
                 "location_id": self.supplier_location.id,
                 "location_dest_id": self.wh.lot_stock_id.id,
@@ -53,15 +56,15 @@
         self.assertEqual(move.product_packaging_qty, 1.0)
         move.write({"product_packaging_qty": 3.0})
         self.assertEqual(move.product_uom_qty, 15.0)
 
     def test_product_uom_qty_change(self):
         picking_f = Form(self.env["stock.picking"])
         picking_f.partner_id = self.partner
-        picking_f.picking_type_id = self.env.ref("stock.picking_type_out")
+        picking_f.picking_type_id = self.picking_type_out
         with picking_f.move_ids_without_package.new() as move_f:
             move_f.product_id = self.product
             self.assertEqual(move_f.product_uom_qty, 1)
             self.assertEqual(move_f.product_packaging_qty, 0)
             self.assertFalse(move_f.product_packaging_id)
             move_f.product_packaging_id = self.packaging
             self.assertEqual(move_f.product_uom_qty, 5)
@@ -79,7 +82,146 @@
                     "product_packaging_qty_done": 1,
                     "product_packaging_qty": 1,
                     "product_uom_qty": 5,
                 }
             ],
         )
         picking.button_validate()
+
+    def test_product_packaging_qty_reserved(self):
+        """Test that the product packaging quantity reserved is correctly set."""
+        product_a = self.env["product.product"].create(
+            {"name": "Product A", "type": "product"}
+        )
+        packaging_product_a = self.env["product.packaging"].create(
+            {"name": "Test packaging", "product_id": product_a.id, "qty": 5.0}
+        )
+        self.pack_location.active = True
+        MoveObj = self.env["stock.move"]
+        picking_client = self.env["stock.picking"].create(
+            {
+                "location_id": self.pack_location.id,
+                "location_dest_id": self.customer_location.id,
+                "picking_type_id": self.picking_type_out.id,
+            }
+        )
+        dest = MoveObj.create(
+            {
+                "name": product_a.name,
+                "product_id": product_a.id,
+                "product_uom_qty": 10,
+                "product_uom": product_a.uom_id.id,
+                "picking_id": picking_client.id,
+                "location_id": self.pack_location.id,
+                "location_dest_id": self.customer_location.id,
+                "state": "waiting",
+                "procure_method": "make_to_order",
+                "product_packaging_id": packaging_product_a.id,
+            }
+        )
+        picking_pick = self.env["stock.picking"].create(
+            {
+                "location_id": self.stock_location.id,
+                "location_dest_id": self.pack_location.id,
+                "picking_type_id": self.picking_type_out.id,
+            }
+        )
+        MoveObj.create(
+            {
+                "name": product_a.name,
+                "product_id": product_a.id,
+                "product_uom_qty": 10,
+                "product_uom": product_a.uom_id.id,
+                "picking_id": picking_pick.id,
+                "location_id": self.stock_location.id,
+                "location_dest_id": self.pack_location.id,
+                "move_dest_ids": [(4, dest.id)],
+                "state": "confirmed",
+                "product_packaging_id": packaging_product_a.id,
+            }
+        )
+        self.env["stock.quant"]._update_available_quantity(
+            product_a, self.stock_location, 10
+        )
+        picking_pick.action_assign()
+        self.assertRecordValues(
+            picking_pick.move_ids_without_package,
+            [
+                {
+                    "product_id": product_a.id,
+                    "product_packaging_id": packaging_product_a.id,
+                    "product_packaging_qty": 2,
+                    "product_uom_qty": 10,
+                    "quantity_done": 0,
+                    "product_packaging_qty_done": 0,
+                }
+            ],
+        )
+        self.assertRecordValues(
+            picking_pick.move_line_ids_without_package,
+            [
+                {
+                    "product_id": product_a.id,
+                    "product_packaging_id": packaging_product_a.id,
+                    "reserved_uom_qty": 10,
+                    "product_packaging_qty_reserved": 2,
+                    "qty_done": 0,
+                    "product_packaging_qty_done": 0,
+                }
+            ],
+        )
+        picking_pick.action_set_quantities_to_reservation()
+        self.assertRecordValues(
+            picking_pick.move_ids_without_package,
+            [
+                {
+                    "product_id": product_a.id,
+                    "product_packaging_id": packaging_product_a.id,
+                    "product_packaging_qty": 2,
+                    "product_uom_qty": 10,
+                    "quantity_done": 10,
+                    "product_packaging_qty_done": 2,
+                }
+            ],
+        )
+        picking_pick._action_done()
+        picking_client.action_assign()
+        self.assertRecordValues(
+            picking_client.move_ids_without_package,
+            [
+                {
+                    "product_id": product_a.id,
+                    "product_packaging_id": packaging_product_a.id,
+                    "product_packaging_qty": 2,
+                    "product_uom_qty": 10,
+                    "quantity_done": 0,
+                    "product_packaging_qty_done": 0,
+                }
+            ],
+        )
+        self.assertRecordValues(
+            picking_client.move_line_ids_without_package,
+            [
+                {
+                    "product_id": product_a.id,
+                    "product_packaging_id": packaging_product_a.id,
+                    "reserved_uom_qty": 10,
+                    "product_packaging_qty_reserved": 2,
+                    "qty_done": 0,
+                    "product_packaging_qty_done": 0,
+                }
+            ],
+        )
+        picking_pick.action_set_quantities_to_reservation()
+        self.assertRecordValues(
+            picking_pick.move_ids_without_package,
+            [
+                {
+                    "product_id": product_a.id,
+                    "product_packaging_id": packaging_product_a.id,
+                    "product_packaging_qty": 2,
+                    "product_uom_qty": 10,
+                    "quantity_done": 10,
+                    "product_packaging_qty_done": 2,
+                }
+            ],
+        )
```

## odoo/addons/stock_move_packaging_qty/views/stock_move_line_view.xml

### odoo/addons/stock_move_packaging_qty/views/stock_move_line_view.xml

```diff
@@ -3,14 +3,17 @@
      License LGPL-3.0 or later (https://www.gnu.org/licenses/lgpl-3.0) -->
 <data>
   <record id="view_stock_move_line_operation_tree" model="ir.ui.view">
     <field name="name">Add product packaging qty done info</field>
     <field name="model">stock.move.line</field>
     <field name="inherit_id" ref="stock.view_stock_move_line_operation_tree"/>
     <field name="arch" type="xml">
+      <field name="reserved_uom_qty" position="before">
+        <field name="product_packaging_qty_reserved" attrs="{'invisible': [('product_packaging_id', '=', False)]}" groups="product.group_stock_packaging"/>
+      </field>
       <field name="qty_done" position="before">
         <field name="product_packaging_id" invisible="1"/>
         <field name="product_packaging_qty_done" attrs="{'invisible': [('product_packaging_id', '=', False)]}" groups="product.group_stock_packaging"/>
       </field>
     </field>
   </record>
   <record id="view_stock_move_line_mobile_form_extension" model="ir.ui.view">
```

## Comparing `odoo_addon_stock_move_packaging_qty-16.0.1.4.0.2.dist-info/METADATA` & `odoo_addon_stock_move_packaging_qty-16.0.1.5.0.dist-info/METADATA`

 * *Files 5% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: odoo-addon-stock-move-packaging-qty
-Version: 16.0.1.4.0.2
+Version: 16.0.1.5.0
 Summary: Add packaging fields in the stock moves
 Home-page: https://github.com/OCA/stock-logistics-warehouse
 Author: ForgeFlow, Odoo Community Association (OCA)
 Author-email: support@odoo-community.org
 License: LGPL-3
 Platform: UNKNOWN
 Classifier: Programming Language :: Python
@@ -19,15 +19,15 @@
 ===================
 
 .. 
    !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
    !! This file is generated by oca-gen-addon-readme !!
    !! changes will be overwritten.                   !!
    !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
-   !! source digest: sha256:f762cbab1bc1e42ef6e66f92bbd7557223f9c6faa21797ac22edb0e40fedad71
+   !! source digest: sha256:5b8f860ba729ede992476459b447110fc34c95d4543e9f17afe7f0489724975e
    !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
 
 .. |badge1| image:: https://img.shields.io/badge/maturity-Beta-yellow.png
     :target: https://odoo-community.org/page/development-status
     :alt: Beta
 .. |badge2| image:: https://img.shields.io/badge/licence-LGPL--3-blue.png
     :target: http://www.gnu.org/licenses/lgpl-3.0-standalone.html
@@ -97,17 +97,20 @@
 OCA, or the Odoo Community Association, is a nonprofit organization whose
 mission is to support the collaborative development of Odoo features and
 promote its widespread use.
 
 .. |maintainer-yajo| image:: https://github.com/yajo.png?size=40px
     :target: https://github.com/yajo
     :alt: yajo
+.. |maintainer-EmilioPascual| image:: https://github.com/EmilioPascual.png?size=40px
+    :target: https://github.com/EmilioPascual
+    :alt: EmilioPascual
 
-Current `maintainer <https://odoo-community.org/page/maintainer-role>`__:
+Current `maintainers <https://odoo-community.org/page/maintainer-role>`__:
 
-|maintainer-yajo| 
+|maintainer-yajo| |maintainer-EmilioPascual| 
 
 This module is part of the `OCA/stock-logistics-warehouse <https://github.com/OCA/stock-logistics-warehouse/tree/16.0/stock_move_packaging_qty>`_ project on GitHub.
 
 You are welcome to contribute. To learn how please visit https://odoo-community.org/page/Contribute.
```

## Comparing `odoo_addon_stock_move_packaging_qty-16.0.1.4.0.2.dist-info/RECORD` & `odoo_addon_stock_move_packaging_qty-16.0.1.5.0.dist-info/RECORD`

 * *Files 8% similar despite different names*

```diff
@@ -1,25 +1,25 @@
-odoo/addons/stock_move_packaging_qty/README.rst,sha256=K7RGuQlJHyn15E-OkFhyDEipr_q0MdQtq82q4zWH7mQ,3656
+odoo/addons/stock_move_packaging_qty/README.rst,sha256=ZZDrRQnTdgwlAC3qpnukxrvGhXrHXEGZa3y0f6OSFsE,3839
 odoo/addons/stock_move_packaging_qty/__init__.py,sha256=X9EJGOE2GtZbS0G82PtSXmWSZ_R8jEM0rlJTDliQjp4,21
-odoo/addons/stock_move_packaging_qty/__manifest__.py,sha256=1Wdh88GtpJyAaN1yw4T3N3rvmvs77jVnKLIaHGbiYfU,705
+odoo/addons/stock_move_packaging_qty/__manifest__.py,sha256=jUP8mo2UT6x73XK_DwSnJNXBnEXv6j_KbnTb6bPFvTw,722
 odoo/addons/stock_move_packaging_qty/i18n/es.po,sha256=xSmWMLYTSJMDNmpU5UEkBvTKK4ybXHLdIbhLIFM5yq8,3741
 odoo/addons/stock_move_packaging_qty/i18n/it.po,sha256=6pZtUqCtmFQqClY0xEIKNIdJhxgV0OW4scv0yhIBYAg,3921
 odoo/addons/stock_move_packaging_qty/i18n/stock_move_packaging_qty.pot,sha256=Hb3jBXA4TOtstSJ456Gqv4J6AYSC6ioTvoRDNji2FA4,3068
 odoo/addons/stock_move_packaging_qty/migrations/15.0.0/pre-migrate.py,sha256=acA7iJh8_7x0PBMh5lXOleL8Ukz6qUicttrD16dyROw,659
 odoo/addons/stock_move_packaging_qty/models/__init__.py,sha256=7oN8BTrFbjHJhXxnvmHz3uUZg12wkNqwjbr49s2l5mk,55
-odoo/addons/stock_move_packaging_qty/models/stock_move.py,sha256=833EAc5cvlAtffnpi74CkpAXNt98Wnh6cCsIFVn6Rk8,5003
-odoo/addons/stock_move_packaging_qty/models/stock_move_line.py,sha256=Mc-Fxuv8ClY21Yj0QpAxfVHj4KsWuH416kjkIJjO8Fg,2978
+odoo/addons/stock_move_packaging_qty/models/stock_move.py,sha256=ny6lvVudD40uhFNS-7Cdq16eArxuF_Uj5s8udoZTw_0,7401
+odoo/addons/stock_move_packaging_qty/models/stock_move_line.py,sha256=v73iHQaTvAo9PeWgMYv83_ILbxAbOcDljMr7qRJnbP8,2305
 odoo/addons/stock_move_packaging_qty/readme/CONTRIBUTORS.rst,sha256=qA68Rc27JGcUpm1yng9tbzWTteytKfUoWDhSOlOwp94,254
 odoo/addons/stock_move_packaging_qty/readme/DESCRIPTION.rst,sha256=mqR6_2S4So8qz5njvqMYcZKpkcefRMAgM3E8Y44K3Ag,72
 odoo/addons/stock_move_packaging_qty/readme/ROADMAP.rst,sha256=BARunbt9QB-23VTLixeRObra166Q9ohbMU1TLNpFf1U,176
 odoo/addons/stock_move_packaging_qty/static/description/icon.png,sha256=6xBPJauaFOF0KDHfHgQopSc28kKvxMaeoQFQWZtfZDo,9455
-odoo/addons/stock_move_packaging_qty/static/description/index.html,sha256=0gCPmXtSsUNy8XMVMoXy3duxOoAt04f5ReG7E8QJzz0,13387
+odoo/addons/stock_move_packaging_qty/static/description/index.html,sha256=5NtDW8JGnZGlmLzF7imZXFoHiKo1guHxP7rRFcAYWt0,13559
 odoo/addons/stock_move_packaging_qty/tests/__init__.py,sha256=ndHmGR6Ce3xVIlSHGPNXXs_wB20hABVi99ClRh2NuiM,44
-odoo/addons/stock_move_packaging_qty/tests/test_stock_move_packaging_qty.py,sha256=i9aumrNXZLQiK4hBuj6eNVr7talQHNh8qYT_0nQvbPk,3643
+odoo/addons/stock_move_packaging_qty/tests/test_stock_move_packaging_qty.py,sha256=YkpdOErekcS9wbVYx8NC6_zA55zPd9nd6pIy9JdGrHk,9110
 odoo/addons/stock_move_packaging_qty/views/report_stock_picking.xml,sha256=XE9p7EVtMKu9kdwLv--2EKvxQ_410rysKWnXZnqzYDU,4922
-odoo/addons/stock_move_packaging_qty/views/stock_move_line_view.xml,sha256=s0HNubLukLL35oJTxVmTw6H46wV9lUJDawl6lTr6bMg,4812
+odoo/addons/stock_move_packaging_qty/views/stock_move_line_view.xml,sha256=3J7ksOLd2RmAQ6EQzayE-BqippDlsQGdkzNe-DcWBkA,5136
 odoo/addons/stock_move_packaging_qty/views/stock_move_view.xml,sha256=qCVkgx6DdQ9HcY3g8mRJIY_WaxsWk3WVmRxhM3eO6FI,3178
 odoo/addons/stock_move_packaging_qty/views/stock_picking_form_view.xml,sha256=P7Cxjzr77pi3h-d73YtspgtvEiYdTVwy0SK3zvJg034,1422
-odoo_addon_stock_move_packaging_qty-16.0.1.4.0.2.dist-info/METADATA,sha256=KNzTLgJmrd144xVB2t7DaLkzWhpscsMRB1zpwqm0OMk,4238
-odoo_addon_stock_move_packaging_qty-16.0.1.4.0.2.dist-info/WHEEL,sha256=GJ7t_kWBFywbagK5eo9IoUwLW6oyOeTKmQ-9iHFVNxQ,92
-odoo_addon_stock_move_packaging_qty-16.0.1.4.0.2.dist-info/top_level.txt,sha256=qBj40grFkGOfDZ2WDSw3y1RnDlgG0u8rP8pvGNdbz4w,5
-odoo_addon_stock_move_packaging_qty-16.0.1.4.0.2.dist-info/RECORD,,
+odoo_addon_stock_move_packaging_qty-16.0.1.5.0.dist-info/METADATA,sha256=bda8Mb5B4QTZbHlrA-6F6nWN0mef8gH1Gb69UA_QB8o,4419
+odoo_addon_stock_move_packaging_qty-16.0.1.5.0.dist-info/WHEEL,sha256=GJ7t_kWBFywbagK5eo9IoUwLW6oyOeTKmQ-9iHFVNxQ,92
+odoo_addon_stock_move_packaging_qty-16.0.1.5.0.dist-info/top_level.txt,sha256=qBj40grFkGOfDZ2WDSw3y1RnDlgG0u8rP8pvGNdbz4w,5
+odoo_addon_stock_move_packaging_qty-16.0.1.5.0.dist-info/RECORD,,
```

